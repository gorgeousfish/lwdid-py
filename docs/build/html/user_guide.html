

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Guide &mdash; lwdid 0.2.0</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=938c9ccc"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples/index.html" />
    <link rel="prev" title="Quick Start" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            lwdid
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#system-requirements">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-methods">Installation Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#install-via-pip-recommended">Install via pip (Recommended)</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#install-from-source">Install from Source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#common-issues">Common Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#numpy-version-conflicts">numpy Version Conflicts</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#statsmodels-installation-failure">statsmodels Installation Failure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#basic-example">Basic Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#simplest-usage">Simplest Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#key-parameters">Key Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#required-parameters">Required Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#common-options">Common Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#small-sample-exact-inference">Small-Sample Exact Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#large-sample-inference">Large-Sample Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#doubly-robust-estimation">Doubly Robust Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#randomization-inference">Randomization Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#adding-control-variables">Adding Control Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#quarterly-data">Quarterly Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#results-object">Results Object</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#core-attributes">Core Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#sample-information">Sample Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#period-specific-effects">Period-Specific Effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#data-format-requirements">Data Format Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#panel-data-structure">Panel Data Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#key-requirements">Key Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#staggered-adoption">Staggered Adoption</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#staggered-results">Staggered Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#key-staggered-parameters">Key Staggered Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scenario-selection-guide">Scenario Selection Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-reference">Quick Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transformation-methods">Transformation Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#demean-standard-did-with-unit-fixed-effects">demean: Standard DiD with Unit Fixed Effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#detrend-did-with-unit-specific-linear-trends">detrend: DiD with Unit-Specific Linear Trends</a></li>
<li class="toctree-l3"><a class="reference internal" href="#demeanq-seasonal-data-with-seasonal-fixed-effects">demeanq: Seasonal Data with Seasonal Fixed Effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#detrendq-seasonal-data-with-trends-and-seasonal-effects">detrendq: Seasonal Data with Trends and Seasonal Effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automatic-frequency-detection">Automatic Frequency Detection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#variance-estimation">Variance Estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ols-homoskedastic">OLS (Homoskedastic)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hc0-white-s-heteroskedasticity-consistent">HC0 (Whiteâ€™s Heteroskedasticity-Consistent)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hc1-heteroskedasticity-robust">HC1 (Heteroskedasticity-Robust)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hc2-leverage-adjusted">HC2 (Leverage-Adjusted)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hc3-small-sample-adjusted-robust">HC3 (Small-Sample Adjusted Robust)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hc4-high-leverage-adjusted">HC4 (High-Leverage Adjusted)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cluster-robust">Cluster-Robust</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#randomization-inference">Randomization Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ri-methods">RI Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-ri-results">Accessing RI Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#control-variables">Control Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#effect-on-inference">Effect on Inference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-results">Working with Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#core-estimates">Core Estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#period-specific-effects">Period-Specific Effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sample-information">Sample Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualization">Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#export-results">Export Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#print-summary">Print Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-requirements-and-validation">Data Requirements and Validation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#panel-structure">Panel Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#treatment-structure">Treatment Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#treatment-indicator">Treatment Indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#missing-data">Missing Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#never-treated-unit-data-preparation">Never-Treated Unit Data Preparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#valid-never-treated-encodings">Valid Never-Treated Encodings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#converting-from-stata-data">Converting from Stata Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checking-never-treated-status">Checking Never-Treated Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#common-issues-and-solutions">Common Issues and Solutions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#choosing-transformation-method">Choosing Transformation Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#choosing-variance-estimator">Choosing Variance Estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sample-size-considerations">Sample Size Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sample-size-and-inference-method-selection-matrix">Sample Size and Inference Method Selection Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#estimator-selection-large-sample-common-timing">Estimator Selection (Large-Sample Common Timing)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#diagnostic-checks">Diagnostic Checks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#common-errors">Common Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance-tips">Performance Tips</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#staggered-adoption-design">Staggered Adoption Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#staggered-specific-parameters">Staggered-Specific Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#robustness-to-no-anticipation-violations">Robustness to No-Anticipation Violations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-staggered-results">Accessing Staggered Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#control-group-strategies">Control Group Strategies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#estimator-selection">Estimator Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#staggered-example">Staggered Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pre-treatment-dynamics-and-parallel-trends-testing">Pre-treatment Dynamics and Parallel Trends Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#why-pre-treatment-dynamics-matter">Why Pre-treatment Dynamics Matter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-pre-treatment-results">Accessing Pre-treatment Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpreting-the-parallel-trends-test">Interpreting the Parallel Trends Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#event-study-visualization-with-pre-treatment">Event Study Visualization with Pre-treatment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#complete-workflow-example">Complete Workflow Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transformation-methods-for-pre-treatment">Transformation Methods for Pre-treatment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#trend-diagnostics-tools">Trend Diagnostics Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#testing-parallel-trends-with-standalone-function">Testing Parallel Trends with Standalone Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#diagnosing-heterogeneous-trends">Diagnosing Heterogeneous Trends</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-automated-transformation-recommendation">Getting Automated Transformation Recommendation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualizing-cohort-trends">Visualizing Cohort Trends</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#basic-did-estimation">Basic DiD Estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#california-smoking-restriction">California Smoking Restriction</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#robustness-checks">Robustness Checks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#quarterly-data">Quarterly Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#retail-sales-with-seasonal-patterns">Retail Sales with Seasonal Patterns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#monthly-data">Monthly Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#monthly-sales-with-seasonal-adjustment-q-12">Monthly Sales with Seasonal Adjustment (Q=12)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#weekly-data">Weekly Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#weekly-sales-with-seasonal-adjustment-q-52">Weekly Sales with Seasonal Adjustment (Q=52)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#control-variables">Control Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#including-baseline-characteristics">Including Baseline Characteristics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#cluster-robust-inference">Cluster-Robust Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#multi-level-data-structure">Multi-Level Data Structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#randomization-inference">Randomization Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#non-parametric-testing">Non-Parametric Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#comparing-ri-methods">Comparing RI Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#diagnostic-checks">Diagnostic Checks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#testing-parallel-trends">Testing Parallel Trends</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#sensitivity-analysis">Sensitivity Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#export-and-reporting">Export and Reporting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#creating-publication-tables">Creating Publication Tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#staggered-did-castle-law">Staggered DiD: Castle Law</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#castle-doctrine-analysis">Castle Doctrine Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#complete-workflow-example">Complete Workflow Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/index.html#end-to-end-analysis">End-to-End Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/index.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/index.html#core-modules">Core Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/core.html">Core Module (core)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/core.html#main-function">Main Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/core.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/core.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/results.html">Results Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/results.html#attributes-reference">Attributes Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/results.html#methods-reference">Methods Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/results.html#usage-by-design-type">Usage by Design Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/results.html#lwdidresults-class">LWDIDResults Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/results.html#example-usage">Example Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/results.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/staggered.html">Staggered DiD Module (staggered)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#transformations">Transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#control-groups">Control Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#estimation">Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#aggregation">Aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#ipw-estimator">IPW Estimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#ipwra-estimator">IPWRA Estimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#psm-estimator">PSM Estimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#inference-distribution-by-estimator">Inference Distribution by Estimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#randomization-inference">Randomization Inference</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#pre-treatment-dynamics">Pre-treatment Dynamics</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/staggered.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/transformations.html">Transformations Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/transformations.html#available-transformations">Available Transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/transformations.html#id1">Available Transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/transformations.html#main-function">Main Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/transformations.html#unit-level-functions">Unit-Level Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/transformations.html#internal-functions">Internal Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/transformations.html#example-usage">Example Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/transformations.html#transformation-selection-guide">Transformation Selection Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/transformations.html#staggered-adoption-transformations">Staggered Adoption Transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/transformations.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/estimation.html">Estimation Module (estimation)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#lwdid.estimation.prepare_controls"><code class="docutils literal notranslate"><span class="pre">prepare_controls()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#lwdid.estimation.estimate_att"><code class="docutils literal notranslate"><span class="pre">estimate_att()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#lwdid.estimation.estimate_period_effects"><code class="docutils literal notranslate"><span class="pre">estimate_period_effects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#estimation-functions">Estimation Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#variance-estimators">Variance Estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#implementation-details">Implementation Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#technical-notes">Technical Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#example-usage">Example Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#large-sample-inference">Large-Sample Inference</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#estimator-selection-for-large-samples">Estimator Selection for Large Samples</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/estimation.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/index.html#inference-and-diagnostics">Inference and Diagnostics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/inference.html">Inference Module (inference)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/inference.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/inference.html#wild-cluster-bootstrap">Wild Cluster Bootstrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/inference.html#example-usage">Example Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/inference.html#methodological-notes">Methodological Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/inference.html#guidelines">Guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/inference.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/clustering_diagnostics.html">Clustering Diagnostics Module (clustering_diagnostics)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/clustering_diagnostics.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/clustering_diagnostics.html#enums">Enums</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/clustering_diagnostics.html#data-classes">Data Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/clustering_diagnostics.html#main-functions">Main Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/clustering_diagnostics.html#example-usage">Example Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/clustering_diagnostics.html#guidelines">Guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/clustering_diagnostics.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/trend_diagnostics.html">Trend Diagnostics Module (trend_diagnostics)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.TrendTestMethod"><code class="docutils literal notranslate"><span class="pre">TrendTestMethod</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.TransformationMethod"><code class="docutils literal notranslate"><span class="pre">TransformationMethod</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.RecommendationConfidence"><code class="docutils literal notranslate"><span class="pre">RecommendationConfidence</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.PreTrendEstimate"><code class="docutils literal notranslate"><span class="pre">PreTrendEstimate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.CohortTrendEstimate"><code class="docutils literal notranslate"><span class="pre">CohortTrendEstimate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.TrendDifference"><code class="docutils literal notranslate"><span class="pre">TrendDifference</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.ParallelTrendsTestResult"><code class="docutils literal notranslate"><span class="pre">ParallelTrendsTestResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.HeterogeneousTrendsDiagnostics"><code class="docutils literal notranslate"><span class="pre">HeterogeneousTrendsDiagnostics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.TransformationRecommendation"><code class="docutils literal notranslate"><span class="pre">TransformationRecommendation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.test_parallel_trends"><code class="docutils literal notranslate"><span class="pre">test_parallel_trends()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.diagnose_heterogeneous_trends"><code class="docutils literal notranslate"><span class="pre">diagnose_heterogeneous_trends()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.recommend_transformation"><code class="docutils literal notranslate"><span class="pre">recommend_transformation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#lwdid.trend_diagnostics.plot_cohort_trends"><code class="docutils literal notranslate"><span class="pre">plot_cohort_trends()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#testing-functions">Testing Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#visualization">Visualization</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#enumerations">Enumerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#result-classes">Result Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#supporting-data-classes">Supporting Data Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/trend_diagnostics.html#methodological-background">Methodological Background</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/selection_diagnostics.html">Selection Diagnostics Module (selection_diagnostics)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/selection_diagnostics.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/selection_diagnostics.html#enums">Enums</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/selection_diagnostics.html#data-classes">Data Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/selection_diagnostics.html#main-functions">Main Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/selection_diagnostics.html#example-usage">Example Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/selection_diagnostics.html#interpretation-guide">Interpretation Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/selection_diagnostics.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/sensitivity.html">Sensitivity Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/sensitivity.html#main-functions">Main Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/sensitivity.html#result-classes">Result Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/sensitivity.html#enumerations">Enumerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/sensitivity.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/sensitivity.html#interpreting-results">Interpreting Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/sensitivity.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/index.html#data-processing">Data Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/preprocessing.html">Preprocessing Module (preprocessing)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/preprocessing.html#key-functions">Key Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/preprocessing.html#key-classes">Key Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/preprocessing.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/preprocessing.html#main-functions">Main Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/preprocessing.html#result-classes">Result Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/preprocessing.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/preprocessing.html#methodological-notes">Methodological Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/preprocessing.html#data-requirements">Data Requirements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/validation.html">Validation Module (validation)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#lwdid.validation.validate_and_prepare_data"><code class="docutils literal notranslate"><span class="pre">validate_and_prepare_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#lwdid.validation.validate_season_diversity"><code class="docutils literal notranslate"><span class="pre">validate_season_diversity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#lwdid.validation.validate_season_coverage"><code class="docutils literal notranslate"><span class="pre">validate_season_coverage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#lwdid.validation.validate_quarter_diversity"><code class="docutils literal notranslate"><span class="pre">validate_quarter_diversity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#lwdid.validation.validate_quarter_coverage"><code class="docutils literal notranslate"><span class="pre">validate_quarter_coverage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#lwdid.validation.get_cohort_mask"><code class="docutils literal notranslate"><span class="pre">get_cohort_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#lwdid.validation.is_never_treated"><code class="docutils literal notranslate"><span class="pre">is_never_treated()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#lwdid.validation.validate_staggered_data"><code class="docutils literal notranslate"><span class="pre">validate_staggered_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#lwdid.validation.detect_frequency"><code class="docutils literal notranslate"><span class="pre">detect_frequency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#validation-checks">Validation Checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#validation-functions">Validation Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#never-treated-unit-identification">Never-Treated Unit Identification</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#staggered-adoption-validation">Staggered Adoption Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#common-validation-errors-and-solutions">Common Validation Errors and Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#best-practices">Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/validation.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/randomization.html">Randomization Inference Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/randomization.html#main-function">Main Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/randomization.html#resampling-methods">Resampling Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/randomization.html#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/randomization.html#returns">Returns</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/randomization.html#example-usage">Example Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/randomization.html#methodological-notes">Methodological Notes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/randomization.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/visualization.html">Visualization Module (visualization)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#lwdid.visualization.prepare_plot_data"><code class="docutils literal notranslate"><span class="pre">prepare_plot_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#lwdid.visualization.plot_results"><code class="docutils literal notranslate"><span class="pre">plot_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#plot-components">Plot Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#advanced-customization">Advanced Customization</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#staggered-adoption-visualization">Staggered Adoption Visualization</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#exporting-plots">Exporting Plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#plot-parameters-reference">Plot Parameters Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#examples-gallery">Examples Gallery</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/visualization.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/exceptions.html">Exceptions Module (exceptions)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.LWDIDError"><code class="docutils literal notranslate"><span class="pre">LWDIDError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.InvalidParameterError"><code class="docutils literal notranslate"><span class="pre">InvalidParameterError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.InvalidRollingMethodError"><code class="docutils literal notranslate"><span class="pre">InvalidRollingMethodError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.InvalidVCETypeError"><code class="docutils literal notranslate"><span class="pre">InvalidVCETypeError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.UnbalancedPanelError"><code class="docutils literal notranslate"><span class="pre">UnbalancedPanelError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.InsufficientDataError"><code class="docutils literal notranslate"><span class="pre">InsufficientDataError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.NoTreatedUnitsError"><code class="docutils literal notranslate"><span class="pre">NoTreatedUnitsError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.NoControlUnitsError"><code class="docutils literal notranslate"><span class="pre">NoControlUnitsError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.InsufficientPrePeriodsError"><code class="docutils literal notranslate"><span class="pre">InsufficientPrePeriodsError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.InsufficientQuarterDiversityError"><code class="docutils literal notranslate"><span class="pre">InsufficientQuarterDiversityError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.TimeDiscontinuityError"><code class="docutils literal notranslate"><span class="pre">TimeDiscontinuityError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.MissingRequiredColumnError"><code class="docutils literal notranslate"><span class="pre">MissingRequiredColumnError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.RandomizationError"><code class="docutils literal notranslate"><span class="pre">RandomizationError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.VisualizationError"><code class="docutils literal notranslate"><span class="pre">VisualizationError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.InvalidStaggeredDataError"><code class="docutils literal notranslate"><span class="pre">InvalidStaggeredDataError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.NoNeverTreatedError"><code class="docutils literal notranslate"><span class="pre">NoNeverTreatedError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.AggregationError"><code class="docutils literal notranslate"><span class="pre">AggregationError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.InvalidAggregationError"><code class="docutils literal notranslate"><span class="pre">InvalidAggregationError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#lwdid.exceptions.InsufficientCellSizeError"><code class="docutils literal notranslate"><span class="pre">InsufficientCellSizeError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#exception-hierarchy">Exception Hierarchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#exception-classes">Exception Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#error-handling-best-practices">Error Handling Best Practices</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#common-error-scenarios">Common Error Scenarios</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/exceptions.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/index.html#quick-index">Quick Index</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="methodological_notes.html">Methodological Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#the-panel-to-cross-section-transformation">The Panel-to-Cross-Section Transformation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#core-principle">Core Principle</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#demean-transformation-procedure-2-1">Demean Transformation (Procedure 2.1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#detrend-transformation-procedure-3-1">Detrend Transformation (Procedure 3.1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#seasonal-transformations-demeanq-detrendq">Seasonal Transformations (demeanq/detrendq)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#inference-under-clm-assumptions">Inference Under CLM Assumptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#classical-linear-model-assumptions">Classical Linear Model Assumptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#degrees-of-freedom">Degrees of Freedom</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#period-specific-effects">Period-Specific Effects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#robust-inference">Robust Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#heteroskedasticity-robust-standard-errors">Heteroskedasticity-Robust Standard Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#cluster-robust-standard-errors">Cluster-Robust Standard Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#randomization-inference">Randomization Inference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#clustering-at-higher-levels">Clustering at Higher Levels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#when-to-cluster-at-higher-levels">When to Cluster at Higher Levels</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#minimum-cluster-requirements">Minimum Cluster Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#id1">Degrees of Freedom</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#diagnosing-clustering-structure">Diagnosing Clustering Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#getting-a-clustering-recommendation">Getting a Clustering Recommendation</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#checking-clustering-consistency">Checking Clustering Consistency</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#wild-cluster-bootstrap">Wild Cluster Bootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#clustering-workflow">Clustering Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#references-for-clustering">References for Clustering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#large-sample-asymptotic-inference">Large-Sample Asymptotic Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#asymptotic-theory">Asymptotic Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#doubly-robust-estimation">Doubly Robust Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#efficiency-considerations">Efficiency Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="methodological_notes.html#monte-carlo-simulation-evidence">Monte Carlo Simulation Evidence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#when-to-use-large-sample-methods">When to Use Large-Sample Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#inference-distribution-by-estimator">Inference Distribution by Estimator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#identification-assumptions">Identification Assumptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#no-anticipation">No Anticipation</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#parallel-trends">Parallel Trends</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#common-treatment-timing-common-timing-mode">Common Treatment Timing (Common Timing Mode)</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#treatment-persistence">Treatment Persistence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#unbalanced-panels-and-selection-mechanism">Unbalanced Panels and Selection Mechanism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#selection-mechanism-assumption">Selection Mechanism Assumption</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#acceptable-missing-data-patterns">Acceptable Missing Data Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#problematic-missing-data-patterns">Problematic Missing Data Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#detrending-for-robustness">Detrending for Robustness</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#diagnosing-selection-risk">Diagnosing Selection Risk</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#controlling-panel-balance">Controlling Panel Balance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#heterogeneous-trends-and-assumption-cht">Heterogeneous Trends and Assumption CHT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#assumption-cht">Assumption CHT</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#first-difference-under-cht">First Difference Under CHT</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#choosing-between-demean-and-detrend">Choosing Between Demean and Detrend</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#procedure-5-1-detrending-under-cht">Procedure 5.1: Detrending Under CHT</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#testing-parallel-trends">Testing Parallel Trends</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#diagnosing-heterogeneous-trends">Diagnosing Heterogeneous Trends</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#getting-a-transformation-recommendation">Getting a Transformation Recommendation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#pre-treatment-period-dynamics">Pre-treatment Period Dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#motivation">Motivation</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#rolling-transformation-for-pre-treatment-periods">Rolling Transformation for Pre-treatment Periods</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#anchor-point-convention">Anchor Point Convention</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#pre-treatment-att-estimation">Pre-treatment ATT Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#control-group-for-pre-treatment-periods">Control Group for Pre-treatment Periods</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#joint-test-for-parallel-trends">Joint Test for Parallel Trends</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#comparison-with-other-did-methods">Comparison with Other DiD Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#two-way-fixed-effects-twfe">Two-Way Fixed Effects (TWFE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#callaway-and-sant-anna-2021">Callaway and Santâ€™Anna (2021)</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#when-to-use-this-method">When to Use This Method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#practical-considerations">Practical Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#sample-size-requirements">Sample Size Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#time-index-and-panel-structure">Time Index and Panel Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#pre-treatment-periods">Pre-Treatment Periods</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#control-variables">Control Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#computational-considerations">Computational Considerations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#staggered-adoption">Staggered Adoption</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#identification">Identification</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#transformation">Transformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#control-group-strategies">Control Group Strategies</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#all-units-eventually-treated">All Units Eventually Treated</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#estimation-methods">Estimation Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#id2">Inference Distribution by Estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#aggregation">Aggregation</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#event-time-aggregation-watt">Event Time Aggregation (WATT)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#robustness-to-pre-treatment-period-selection">Robustness to Pre-treatment Period Selection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#id3">Motivation</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#sensitivity-ratio">Sensitivity Ratio</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#using-robustness-pre-periods">Using robustness_pre_periods()</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#no-anticipation-sensitivity">No-Anticipation Sensitivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#using-exclude-pre-periods-parameter">Using exclude_pre_periods Parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="methodological_notes.html#comprehensive-sensitivity-analysis">Comprehensive Sensitivity Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="methodological_notes.html#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#how-to-contribute">How to Contribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#development-setup">Development Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#code-standards">Code Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#reporting-issues">Reporting Issues</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">lwdid</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">User Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/user_guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="user-guide">
<h1>User Guide<a class="headerlink" href="#user-guide" title="Link to this heading">ïƒ</a></h1>
<p>This guide covers all aspects of using the <code class="docutils literal notranslate"><span class="pre">lwdid</span></code> package for difference-in-differences
estimation with rolling transformations.</p>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id4">Overview</a></p></li>
<li><p><a class="reference internal" href="#scenario-selection-guide" id="id5">Scenario Selection Guide</a></p></li>
<li><p><a class="reference internal" href="#quick-reference" id="id6">Quick Reference</a></p></li>
<li><p><a class="reference internal" href="#transformation-methods" id="id7">Transformation Methods</a></p>
<ul>
<li><p><a class="reference internal" href="#demean-standard-did-with-unit-fixed-effects" id="id8">demean: Standard DiD with Unit Fixed Effects</a></p></li>
<li><p><a class="reference internal" href="#detrend-did-with-unit-specific-linear-trends" id="id9">detrend: DiD with Unit-Specific Linear Trends</a></p></li>
<li><p><a class="reference internal" href="#demeanq-seasonal-data-with-seasonal-fixed-effects" id="id10">demeanq: Seasonal Data with Seasonal Fixed Effects</a></p></li>
<li><p><a class="reference internal" href="#detrendq-seasonal-data-with-trends-and-seasonal-effects" id="id11">detrendq: Seasonal Data with Trends and Seasonal Effects</a></p></li>
<li><p><a class="reference internal" href="#automatic-frequency-detection" id="id12">Automatic Frequency Detection</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#variance-estimation" id="id13">Variance Estimation</a></p>
<ul>
<li><p><a class="reference internal" href="#ols-homoskedastic" id="id14">OLS (Homoskedastic)</a></p></li>
<li><p><a class="reference internal" href="#hc0-white-s-heteroskedasticity-consistent" id="id15">HC0 (Whiteâ€™s Heteroskedasticity-Consistent)</a></p></li>
<li><p><a class="reference internal" href="#hc1-heteroskedasticity-robust" id="id16">HC1 (Heteroskedasticity-Robust)</a></p></li>
<li><p><a class="reference internal" href="#hc2-leverage-adjusted" id="id17">HC2 (Leverage-Adjusted)</a></p></li>
<li><p><a class="reference internal" href="#hc3-small-sample-adjusted-robust" id="id18">HC3 (Small-Sample Adjusted Robust)</a></p></li>
<li><p><a class="reference internal" href="#hc4-high-leverage-adjusted" id="id19">HC4 (High-Leverage Adjusted)</a></p></li>
<li><p><a class="reference internal" href="#cluster-robust" id="id20">Cluster-Robust</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#randomization-inference" id="id21">Randomization Inference</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-usage" id="id22">Basic Usage</a></p></li>
<li><p><a class="reference internal" href="#ri-methods" id="id23">RI Methods</a></p></li>
<li><p><a class="reference internal" href="#accessing-ri-results" id="id24">Accessing RI Results</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#control-variables" id="id25">Control Variables</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id26">Basic Usage</a></p></li>
<li><p><a class="reference internal" href="#requirements" id="id27">Requirements</a></p></li>
<li><p><a class="reference internal" href="#effect-on-inference" id="id28">Effect on Inference</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#working-with-results" id="id29">Working with Results</a></p>
<ul>
<li><p><a class="reference internal" href="#core-estimates" id="id30">Core Estimates</a></p></li>
<li><p><a class="reference internal" href="#period-specific-effects" id="id31">Period-Specific Effects</a></p></li>
<li><p><a class="reference internal" href="#sample-information" id="id32">Sample Information</a></p></li>
<li><p><a class="reference internal" href="#visualization" id="id33">Visualization</a></p></li>
<li><p><a class="reference internal" href="#export-results" id="id34">Export Results</a></p></li>
<li><p><a class="reference internal" href="#print-summary" id="id35">Print Summary</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#data-requirements-and-validation" id="id36">Data Requirements and Validation</a></p>
<ul>
<li><p><a class="reference internal" href="#panel-structure" id="id37">Panel Structure</a></p></li>
<li><p><a class="reference internal" href="#treatment-structure" id="id38">Treatment Structure</a></p></li>
<li><p><a class="reference internal" href="#treatment-indicator" id="id39">Treatment Indicator</a></p></li>
<li><p><a class="reference internal" href="#missing-data" id="id40">Missing Data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#never-treated-unit-data-preparation" id="id41">Never-Treated Unit Data Preparation</a></p>
<ul>
<li><p><a class="reference internal" href="#valid-never-treated-encodings" id="id42">Valid Never-Treated Encodings</a></p></li>
<li><p><a class="reference internal" href="#converting-from-stata-data" id="id43">Converting from Stata Data</a></p></li>
<li><p><a class="reference internal" href="#checking-never-treated-status" id="id44">Checking Never-Treated Status</a></p></li>
<li><p><a class="reference internal" href="#common-issues-and-solutions" id="id45">Common Issues and Solutions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#best-practices" id="id46">Best Practices</a></p>
<ul>
<li><p><a class="reference internal" href="#choosing-transformation-method" id="id47">Choosing Transformation Method</a></p></li>
<li><p><a class="reference internal" href="#choosing-variance-estimator" id="id48">Choosing Variance Estimator</a></p></li>
<li><p><a class="reference internal" href="#sample-size-considerations" id="id49">Sample Size Considerations</a></p></li>
<li><p><a class="reference internal" href="#sample-size-and-inference-method-selection-matrix" id="id50">Sample Size and Inference Method Selection Matrix</a></p></li>
<li><p><a class="reference internal" href="#estimator-selection-large-sample-common-timing" id="id51">Estimator Selection (Large-Sample Common Timing)</a></p></li>
<li><p><a class="reference internal" href="#diagnostic-checks" id="id52">Diagnostic Checks</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#troubleshooting" id="id53">Troubleshooting</a></p>
<ul>
<li><p><a class="reference internal" href="#common-errors" id="id54">Common Errors</a></p></li>
<li><p><a class="reference internal" href="#performance-tips" id="id55">Performance Tips</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#staggered-adoption-design" id="id56">Staggered Adoption Design</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id57">Basic Usage</a></p></li>
<li><p><a class="reference internal" href="#staggered-specific-parameters" id="id58">Staggered-Specific Parameters</a></p></li>
<li><p><a class="reference internal" href="#robustness-to-no-anticipation-violations" id="id59">Robustness to No-Anticipation Violations</a></p></li>
<li><p><a class="reference internal" href="#accessing-staggered-results" id="id60">Accessing Staggered Results</a></p></li>
<li><p><a class="reference internal" href="#control-group-strategies" id="id61">Control Group Strategies</a></p></li>
<li><p><a class="reference internal" href="#estimator-selection" id="id62">Estimator Selection</a></p></li>
<li><p><a class="reference internal" href="#staggered-example" id="id63">Staggered Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#pre-treatment-dynamics-and-parallel-trends-testing" id="id64">Pre-treatment Dynamics and Parallel Trends Testing</a></p>
<ul>
<li><p><a class="reference internal" href="#why-pre-treatment-dynamics-matter" id="id65">Why Pre-treatment Dynamics Matter</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id66">Basic Usage</a></p></li>
<li><p><a class="reference internal" href="#accessing-pre-treatment-results" id="id67">Accessing Pre-treatment Results</a></p></li>
<li><p><a class="reference internal" href="#interpreting-the-parallel-trends-test" id="id68">Interpreting the Parallel Trends Test</a></p></li>
<li><p><a class="reference internal" href="#event-study-visualization-with-pre-treatment" id="id69">Event Study Visualization with Pre-treatment</a></p></li>
<li><p><a class="reference internal" href="#complete-workflow-example" id="id70">Complete Workflow Example</a></p></li>
<li><p><a class="reference internal" href="#transformation-methods-for-pre-treatment" id="id71">Transformation Methods for Pre-treatment</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#trend-diagnostics-tools" id="id72">Trend Diagnostics Tools</a></p>
<ul>
<li><p><a class="reference internal" href="#testing-parallel-trends-with-standalone-function" id="id73">Testing Parallel Trends with Standalone Function</a></p></li>
<li><p><a class="reference internal" href="#diagnosing-heterogeneous-trends" id="id74">Diagnosing Heterogeneous Trends</a></p></li>
<li><p><a class="reference internal" href="#getting-automated-transformation-recommendation" id="id75">Getting Automated Transformation Recommendation</a></p></li>
<li><p><a class="reference internal" href="#visualizing-cohort-trends" id="id76">Visualizing Cohort Trends</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#further-reading" id="id77">Further Reading</a></p></li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading">ïƒ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">lwdid</span></code> package implements the Lee and Wooldridge methods for difference-in-
differences estimation with panel data, covering three main scenarios:</p>
<p><strong>Small-Sample Common Timing</strong> (Lee and Wooldridge, 2026):</p>
<ul class="simple">
<li><p>Exact t-based inference under CLM assumptions (normality and homoskedasticity)</p></li>
<li><p>Designed for settings with small numbers of treated or control units</p></li>
<li><p>Works best with large time dimensions</p></li>
</ul>
<p><strong>Large-Sample Common Timing</strong> (Lee and Wooldridge, 2025):</p>
<ul class="simple">
<li><p>Asymptotic inference with robust standard errors</p></li>
<li><p>Supports heteroskedasticity-robust (HC0-HC4) and cluster-robust options</p></li>
<li><p>Multiple estimators: RA, IPW, IPWRA, PSM</p></li>
</ul>
<p><strong>Staggered Adoption</strong> (Lee and Wooldridge, 2025):</p>
<ul class="simple">
<li><p>Units treated at different times</p></li>
<li><p>Cohort-time specific effect estimation</p></li>
<li><p>Flexible control group strategies and aggregation options</p></li>
</ul>
<p>Key features:</p>
<ul class="simple">
<li><p>Four transformation methods: demean, detrend, demeanq, detrendq</p></li>
<li><p>Multiple variance estimators for different assumptions</p></li>
<li><p>Randomization inference for small samples</p></li>
<li><p>Event study visualization for staggered designs</p></li>
</ul>
</section>
<section id="scenario-selection-guide">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Scenario Selection Guide</a><a class="headerlink" href="#scenario-selection-guide" title="Link to this heading">ïƒ</a></h2>
<p>Use this guide to choose the appropriate scenario for your analysis:</p>
<ul class="simple">
<li><p><strong>Small-sample common timing</strong>: Use when N is small with common treatment
timing. Key parameters: <code class="docutils literal notranslate"><span class="pre">post</span></code>, <code class="docutils literal notranslate"><span class="pre">vce=None</span></code>.</p></li>
<li><p><strong>Large-sample common timing</strong>: Use when N is larger with common treatment
timing. Key parameters: <code class="docutils literal notranslate"><span class="pre">post</span></code>, <code class="docutils literal notranslate"><span class="pre">vce='hc3'</span></code>.</p></li>
<li><p><strong>Staggered adoption</strong>: Use when units are treated at different times. Key
parameters: <code class="docutils literal notranslate"><span class="pre">gvar</span></code>, <code class="docutils literal notranslate"><span class="pre">aggregate</span></code>.</p></li>
</ul>
<p><strong>Decision Flowchart:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  Treatment timing varies        â”‚
                â”‚  across units?                  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                               â”‚
                â–¼                               â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  YES   â”‚                     â”‚   NO    â”‚
           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                â”‚                              â”‚
                â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STAGGERED ADOPTION       â”‚   â”‚  Is cross-sectional N       â”‚
â”‚  Use: gvar parameter      â”‚   â”‚  small (&lt; 50)?              â”‚
â”‚  Estimator: ra/ipwra      â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  Aggregate: cohort/overallâ”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚                               â”‚
                                â–¼                               â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  YES   â”‚                     â”‚   NO    â”‚
                           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                â”‚                              â”‚
                                â–¼                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  SMALL-SAMPLE COMMON TIMING         â”‚   â”‚  LARGE-SAMPLE COMMON TIMING     â”‚
        â”‚  Use: post parameter                â”‚   â”‚  Use: post parameter            â”‚
        â”‚  VCE: None (exact t-inference)      â”‚   â”‚  VCE: hc3 or robust             â”‚
        â”‚  Alt: ri=True for RI                â”‚   â”‚  Estimator: ra/ipwra            â”‚
        â”‚  Reference: Lee and Wooldridge      â”‚   â”‚  Reference: Lee and Wooldridge  â”‚
        â”‚  (2026)                             â”‚   â”‚  (2025)                         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre></div>
</div>
</section>
<section id="quick-reference">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Quick Reference</a><a class="headerlink" href="#quick-reference" title="Link to this heading">ïƒ</a></h2>
<p>For a quick start, see <a class="reference internal" href="quickstart.html"><span class="doc">Quick Start</span></a>. For complete API details, see <a class="reference internal" href="api/index.html"><span class="doc">API Reference</span></a>.</p>
</section>
<section id="transformation-methods">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Transformation Methods</a><a class="headerlink" href="#transformation-methods" title="Link to this heading">ïƒ</a></h2>
<p>Four transformation methods convert panel data into cross-sectional form. The choice
depends on data structure and assumptions.</p>
<section id="demean-standard-did-with-unit-fixed-effects">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">demean: Standard DiD with Unit Fixed Effects</a><a class="headerlink" href="#demean-standard-did-with-unit-fixed-effects" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Annual data or data without seasonal patterns</p></li>
<li><p>Control for time-invariant unit characteristics</p></li>
<li><p>At least 1 pre-treatment period (<span class="math notranslate nohighlight">\(T_0 \geq 1\)</span>)</p></li>
</ul>
<p><strong>What it does</strong>:</p>
<p>Removes unit-specific pre-treatment means from each observation.</p>
<p><strong>Mathematical form</strong> (Lee and Wooldridge, 2026, Procedure 2.1):</p>
<p>For each unit <span class="math notranslate nohighlight">\(i\)</span>, compute the pre-treatment mean <span class="math notranslate nohighlight">\(\bar{Y}_{i,pre}\)</span> and
transform:</p>
<div class="math notranslate nohighlight">
\[\dot{Y}_{it} = Y_{it} - \bar{Y}_{i,pre} \quad \text{for all } t\]</div>
<p>Then estimate a cross-sectional regression on the transformed data.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="detrend-did-with-unit-specific-linear-trends">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">detrend: DiD with Unit-Specific Linear Trends</a><a class="headerlink" href="#detrend-did-with-unit-specific-linear-trends" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Units exhibit different linear trends in the pre-treatment period</p></li>
<li><p>Control for both unit fixed effects and unit-specific trends</p></li>
<li><p>At least 2 pre-treatment periods (<span class="math notranslate nohighlight">\(T_0 \geq 2\)</span>)</p></li>
</ul>
<p><strong>What it does</strong>:</p>
<p>Estimates and removes unit-specific linear trends from the pre-treatment data.</p>
<p><strong>Mathematical form</strong> (Lee and Wooldridge, 2026, Procedure 3.1):</p>
<p>For each unit <span class="math notranslate nohighlight">\(i\)</span>, estimate linear trend from pre-treatment data:</p>
<div class="math notranslate nohighlight">
\[Y_{it} = \alpha_i + \beta_i t + \varepsilon_{it} \quad \text{(for } t \text{ in pre-treatment period)}\]</div>
<p>Then detrend all observations using the estimated trend.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;detrend&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="demeanq-seasonal-data-with-seasonal-fixed-effects">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">demeanq: Seasonal Data with Seasonal Fixed Effects</a><a class="headerlink" href="#demeanq-seasonal-data-with-seasonal-fixed-effects" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Periodic data with seasonal patterns (quarterly, monthly, or weekly)</p></li>
<li><p>Control for both unit and season-of-year effects</p></li>
<li><p>Pre-treatment sample rich enough to estimate seasonal fixed effects for each unit:
for each unit, the number of pre-treatment observations must be at least Q + 1
(where Q is the number of seasons per year)</p></li>
<li><p>For each unit, every season that appears in the post-treatment period must also
appear in its pre-treatment period (season-coverage condition).</p></li>
</ul>
<p><strong>What it does</strong>:</p>
<p>Removes unit-specific pre-treatment means and season-of-year effects.</p>
<p><strong>Supported seasonal periods (Q parameter)</strong>:</p>
<ul class="simple">
<li><p><strong>Q=4</strong> (default): Quarterly data (4 seasons per year)</p></li>
<li><p><strong>Q=12</strong>: Monthly data (12 seasons per year)</p></li>
<li><p><strong>Q=52</strong>: Weekly data (52 seasons per year)</p></li>
</ul>
<p><strong>Data requirements</strong>:</p>
<ul class="simple">
<li><p>For quarterly data: Pass <code class="docutils literal notranslate"><span class="pre">tvar</span></code> as a list: <code class="docutils literal notranslate"><span class="pre">tvar=['year',</span> <span class="pre">'quarter']</span></code></p></li>
<li><p>For monthly/weekly data: Use a single time variable with <code class="docutils literal notranslate"><span class="pre">Q</span></code> and <code class="docutils literal notranslate"><span class="pre">season_var</span></code> parameters</p></li>
</ul>
<p><strong>Examples</strong>:</p>
<p>Quarterly data (Q=4, default):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data_q</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;quarter&#39;</span><span class="p">],</span>  <span class="c1"># Composite time variable</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demeanq&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Monthly data (Q=12):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data_m</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>              <span class="c1"># Single time index</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demeanq&#39;</span><span class="p">,</span>
    <span class="n">Q</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>                     <span class="c1"># 12 seasons per year</span>
    <span class="n">season_var</span><span class="o">=</span><span class="s1">&#39;month&#39;</span>        <span class="c1"># Month indicator (1-12)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Weekly data (Q=52):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data_w</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>              <span class="c1"># Single time index</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demeanq&#39;</span><span class="p">,</span>
    <span class="n">Q</span><span class="o">=</span><span class="mi">52</span><span class="p">,</span>                     <span class="c1"># 52 seasons per year</span>
    <span class="n">season_var</span><span class="o">=</span><span class="s1">&#39;week&#39;</span>         <span class="c1"># Week indicator (1-52)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="detrendq-seasonal-data-with-trends-and-seasonal-effects">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">detrendq: Seasonal Data with Trends and Seasonal Effects</a><a class="headerlink" href="#detrendq-seasonal-data-with-trends-and-seasonal-effects" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Periodic data with both trends and seasonal patterns</p></li>
<li><p>Control for unit trends and season-of-year effects</p></li>
<li><p>At least Q + 2 pre-treatment observations per unit (where Q is the number of
seasons per year)</p></li>
<li><p>For each unit, every season that appears in the post-treatment period must also
appear in its pre-treatment period (season-coverage condition).</p></li>
</ul>
<p><strong>What it does</strong>:</p>
<p>Combines detrending with seasonal adjustment.</p>
<p><strong>Supported seasonal periods (Q parameter)</strong>:</p>
<ul class="simple">
<li><p><strong>Q=4</strong> (default): Quarterly data (4 seasons per year)</p></li>
<li><p><strong>Q=12</strong>: Monthly data (12 seasons per year)</p></li>
<li><p><strong>Q=52</strong>: Weekly data (52 seasons per year)</p></li>
</ul>
<p><strong>Examples</strong>:</p>
<p>Quarterly data (Q=4, default):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data_q</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;quarter&#39;</span><span class="p">],</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;detrendq&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Monthly data (Q=12):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data_m</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;detrendq&#39;</span><span class="p">,</span>
    <span class="n">Q</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">season_var</span><span class="o">=</span><span class="s1">&#39;month&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Weekly data (Q=52):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data_w</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;detrendq&#39;</span><span class="p">,</span>
    <span class="n">Q</span><span class="o">=</span><span class="mi">52</span><span class="p">,</span>
    <span class="n">season_var</span><span class="o">=</span><span class="s1">&#39;week&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="automatic-frequency-detection">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Automatic Frequency Detection</a><a class="headerlink" href="#automatic-frequency-detection" title="Link to this heading">ïƒ</a></h3>
<p>For convenience, <code class="docutils literal notranslate"><span class="pre">lwdid</span></code> can automatically detect the data frequency and set
the appropriate <code class="docutils literal notranslate"><span class="pre">Q</span></code> parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demeanq&#39;</span><span class="p">,</span>
    <span class="n">auto_detect_frequency</span><span class="o">=</span><span class="kc">True</span>    <span class="c1"># Automatically detect Q</span>
<span class="p">)</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">auto_detect_frequency=True</span></code>, the package examines the time variable to
determine the most likely data frequency:</p>
<ul class="simple">
<li><p>Detects monthly data (Q=12) based on 12 observations per year pattern</p></li>
<li><p>Detects weekly data (Q=52) based on 52 observations per year pattern</p></li>
<li><p>Falls back to quarterly (Q=4) if frequency cannot be determined</p></li>
</ul>
<p><strong>Note</strong>: If both <code class="docutils literal notranslate"><span class="pre">Q</span></code> and <code class="docutils literal notranslate"><span class="pre">auto_detect_frequency=True</span></code> are specified, an error
is raised unless <code class="docutils literal notranslate"><span class="pre">Q=4</span></code> (the default).</p>
</section>
</section>
<section id="variance-estimation">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Variance Estimation</a><a class="headerlink" href="#variance-estimation" title="Link to this heading">ïƒ</a></h2>
<p>The package supports multiple variance estimators for different assumptions
about the error structure.</p>
<section id="ols-homoskedastic">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">OLS (Homoskedastic)</a><a class="headerlink" href="#ols-homoskedastic" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Errors are homoskedastic and normally distributed</p></li>
<li><p>Exact t-based inference is desired</p></li>
</ul>
<p><strong>Specification</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">vce</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># Default</span>
</pre></div>
</div>
<p><strong>Degrees of freedom</strong>:</p>
<ul class="simple">
<li><p>Non-clustered: df equals the residual degrees of freedom from the
cross-sectional regression (df_resid). In a simple specification
without controls this is N - 2 (intercept and treatment indicator);
with controls and interactions it is N minus the total number of
estimated parameters.</p></li>
<li><p>Clustered: df = G - 1 (G clusters)</p></li>
</ul>
</section>
<section id="hc0-white-s-heteroskedasticity-consistent">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">HC0 (Whiteâ€™s Heteroskedasticity-Consistent)</a><a class="headerlink" href="#hc0-white-s-heteroskedasticity-consistent" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Heteroskedasticity is suspected</p></li>
<li><p>Sample size is large</p></li>
</ul>
<p><strong>Specification</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">vce</span><span class="o">=</span><span class="s1">&#39;hc0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Note</strong>: HC0 is the original White (1980) heteroskedasticity-consistent estimator
without finite-sample adjustments. Tends to underestimate standard errors in small
samples.</p>
</section>
<section id="hc1-heteroskedasticity-robust">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">HC1 (Heteroskedasticity-Robust)</a><a class="headerlink" href="#hc1-heteroskedasticity-robust" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Heteroskedasticity is suspected</p></li>
<li><p>Sample size is moderate to large, so asymptotic approximations are more reliable</p></li>
</ul>
<p><strong>Specification</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">vce</span><span class="o">=</span><span class="s1">&#39;hc1&#39;</span><span class="p">)</span>
<span class="c1"># or equivalently:</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">vce</span><span class="o">=</span><span class="s1">&#39;robust&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: <code class="docutils literal notranslate"><span class="pre">'hc1'</span></code> and <code class="docutils literal notranslate"><span class="pre">'robust'</span></code> are aliases for the same estimator. HC1 applies
a degrees-of-freedom correction (n/(n-k)) to HC0.</p>
</section>
<section id="hc2-leverage-adjusted">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">HC2 (Leverage-Adjusted)</a><a class="headerlink" href="#hc2-leverage-adjusted" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Heteroskedasticity is suspected</p></li>
<li><p>Sample size is small to moderate</p></li>
<li><p>Observations have varying leverage</p></li>
</ul>
<p><strong>Specification</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">vce</span><span class="o">=</span><span class="s1">&#39;hc2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Note</strong>: HC2 divides squared residuals by (1 - h_ii) where h_ii is the diagonal
of the hat matrix. Provides better performance than HC1 when leverage varies
across observations.</p>
</section>
<section id="hc3-small-sample-adjusted-robust">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">HC3 (Small-Sample Adjusted Robust)</a><a class="headerlink" href="#hc3-small-sample-adjusted-robust" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Heteroskedasticity is suspected</p></li>
<li><p>Sample size is small or moderate</p></li>
</ul>
<p><strong>Specification</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">vce</span><span class="o">=</span><span class="s1">&#39;hc3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Advantage</strong>: HC3 divides squared residuals by (1 - h_ii)^2, providing better
finite-sample performance than HC1 and HC2 in small samples.</p>
</section>
<section id="hc4-high-leverage-adjusted">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">HC4 (High-Leverage Adjusted)</a><a class="headerlink" href="#hc4-high-leverage-adjusted" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Heteroskedasticity is suspected</p></li>
<li><p>Data contains high-leverage observations</p></li>
</ul>
<p><strong>Specification</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">vce</span><span class="o">=</span><span class="s1">&#39;hc4&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Note</strong>: HC4 uses an adaptive exponent that increases the adjustment for
observations with high leverage. Recommended when the design matrix contains
potentially influential observations.</p>
</section>
<section id="cluster-robust">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Cluster-Robust</a><a class="headerlink" href="#cluster-robust" title="Link to this heading">ïƒ</a></h3>
<p><strong>When to use</strong>:</p>
<ul class="simple">
<li><p>Errors are correlated within clusters (e.g., states, regions)</p></li>
<li><p>Multiple units per cluster</p></li>
</ul>
<p><strong>Specification</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">vce</span><span class="o">=</span><span class="s1">&#39;cluster&#39;</span><span class="p">,</span> <span class="n">cluster_var</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Degrees of freedom</strong>: G - 1, where G is the number of clusters.</p>
<p><strong>Clustering Level Selection</strong>:</p>
<p>Lee and Wooldridge (2025, Section 8.2) provides guidance on choosing the
clustering level. The clustering level should match the level at which the
policy varies:</p>
<ul class="simple">
<li><p>If the unit of observation is county but policy varies at the state level,
cluster at the state level</p></li>
<li><p>If the unit of observation is individual but policy varies at the firm level,
cluster at the firm level</p></li>
</ul>
<p>In general, cluster at the highest level where treatment assignment is
determined. This ensures that standard errors properly account for the
correlation structure induced by the policy variation.</p>
</section>
</section>
<section id="randomization-inference">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">Randomization Inference</a><a class="headerlink" href="#randomization-inference" title="Link to this heading">ïƒ</a></h2>
<p>Randomization inference provides an alternative to t-based inference without
distributional assumptions.</p>
<section id="basic-usage">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Basic Usage</a><a class="headerlink" href="#basic-usage" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span><span class="p">,</span>
    <span class="n">ri</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>        <span class="c1"># Enable RI</span>
    <span class="n">rireps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>    <span class="c1"># Number of randomization replications (default: 1000)</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>         <span class="c1"># Random seed for reproducibility</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RI p-value: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">ri_pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ri-methods">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">RI Methods</a><a class="headerlink" href="#ri-methods" title="Link to this heading">ïƒ</a></h3>
<p>The package supports two RI methods:</p>
<p><strong>Bootstrap</strong> (default):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ri</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ri_method</span><span class="o">=</span><span class="s1">&#39;bootstrap&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>With-replacement resampling.</p>
<p><strong>Permutation</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ri</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ri_method</span><span class="o">=</span><span class="s1">&#39;permutation&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Fisher randomization inference without replacement.</p>
</section>
<section id="accessing-ri-results">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Accessing RI Results</a><a class="headerlink" href="#accessing-ri-results" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">ri_pvalue</span>          <span class="c1"># RI p-value (available if ri=True)</span>
<span class="n">results</span><span class="o">.</span><span class="n">ri_method</span>          <span class="c1"># RI method (&#39;permutation&#39; or &#39;bootstrap&#39;)</span>
<span class="n">results</span><span class="o">.</span><span class="n">rireps</span>             <span class="c1"># Number of RI replications</span>
<span class="n">results</span><span class="o">.</span><span class="n">ri_valid</span>           <span class="c1"># Number of valid RI replications</span>
<span class="n">results</span><span class="o">.</span><span class="n">ri_failed</span>          <span class="c1"># Number of failed RI replications</span>
<span class="n">results</span><span class="o">.</span><span class="n">ri_seed</span>            <span class="c1"># Random seed actually used for RI (auto-generated if not provided)</span>
</pre></div>
</div>
</section>
</section>
<section id="control-variables">
<h2><a class="toc-backref" href="#id25" role="doc-backlink">Control Variables</a><a class="headerlink" href="#control-variables" title="Link to this heading">ïƒ</a></h2>
<p>Time-invariant control variables can be included in the estimation.</p>
<section id="id1">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Basic Usage</a><a class="headerlink" href="#id1" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span><span class="p">,</span>
    <span class="n">controls</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="requirements">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Requirements</a><a class="headerlink" href="#requirements" title="Link to this heading">ïƒ</a></h3>
<ul class="simple">
<li><p>Controls must be time-invariant (constant within each unit)</p></li>
<li><p>Controls are automatically centered (demeaned)</p></li>
<li><p>Missing values in controls are handled at the estimation stage: observations with
missing controls may be dropped if doing so still leaves enough treated and
control units to satisfy the N1&gt;K+1 and N0&gt;K+1 conditions; otherwise controls
are omitted and the full regression sample is retained (with a warning)</p></li>
</ul>
</section>
<section id="effect-on-inference">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Effect on Inference</a><a class="headerlink" href="#effect-on-inference" title="Link to this heading">ïƒ</a></h3>
<p>Including controls:</p>
<ul class="simple">
<li><p>Reduces residual variance (potentially increasing power)</p></li>
<li><p>Reduces degrees of freedom by the number of added regressors (controls and their interactions)</p></li>
<li><p>Controls are centered before inclusion in the cross-sectional regression</p></li>
<li><p>Controls are included only if both the treated and control groups satisfy N1&gt;K+1 and N0&gt;K+1 (where K is the number of controls); otherwise, controls are automatically excluded and a warning is issued</p></li>
</ul>
</section>
</section>
<section id="working-with-results">
<h2><a class="toc-backref" href="#id29" role="doc-backlink">Working with Results</a><a class="headerlink" href="#working-with-results" title="Link to this heading">ïƒ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">lwdid()</span></code> function returns a <code class="docutils literal notranslate"><span class="pre">LWDIDResults</span></code> object with comprehensive
estimation results and export capabilities.</p>
<section id="core-estimates">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">Core Estimates</a><a class="headerlink" href="#core-estimates" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">att</span>           <span class="c1"># Average treatment effect on treated</span>
<span class="n">results</span><span class="o">.</span><span class="n">se_att</span>        <span class="c1"># Standard error</span>
<span class="n">results</span><span class="o">.</span><span class="n">t_stat</span>        <span class="c1"># t-statistic</span>
<span class="n">results</span><span class="o">.</span><span class="n">pvalue</span>        <span class="c1"># Two-sided p-value</span>
<span class="n">results</span><span class="o">.</span><span class="n">ci_lower</span>      <span class="c1"># 95% CI lower bound</span>
<span class="n">results</span><span class="o">.</span><span class="n">ci_upper</span>      <span class="c1"># 95% CI upper bound</span>
<span class="n">results</span><span class="o">.</span><span class="n">df_inference</span>  <span class="c1"># Degrees of freedom</span>
</pre></div>
</div>
</section>
<section id="period-specific-effects">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">Period-Specific Effects</a><a class="headerlink" href="#period-specific-effects" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access period-by-period estimates</span>
<span class="n">df_periods</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">att_by_period</span>

<span class="c1"># DataFrame with columns:</span>
<span class="c1"># - period: Time period label</span>
<span class="c1"># - tindex: Numeric time index</span>
<span class="c1"># - beta: Treatment effect estimate</span>
<span class="c1"># - se: Standard error</span>
<span class="c1"># - ci_lower, ci_upper: 95% confidence interval</span>
<span class="c1"># - tstat: t-statistic</span>
<span class="c1"># - pval: p-value</span>
<span class="c1"># - N: Sample size</span>
<span class="c1"># The first row summarizes the overall average effect (&#39;period&#39; == &#39;average&#39;).</span>
</pre></div>
</div>
</section>
<section id="sample-information">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">Sample Information</a><a class="headerlink" href="#sample-information" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">nobs</span>          <span class="c1"># Total observations in regression</span>
<span class="n">results</span><span class="o">.</span><span class="n">n_treated</span>     <span class="c1"># Number of treated units</span>
<span class="n">results</span><span class="o">.</span><span class="n">n_control</span>     <span class="c1"># Number of control units</span>
<span class="n">results</span><span class="o">.</span><span class="n">K</span>             <span class="c1"># Number of pre-treatment periods</span>
<span class="n">results</span><span class="o">.</span><span class="n">tpost1</span>        <span class="c1"># First post-treatment period index</span>
</pre></div>
</div>
</section>
<section id="visualization">
<h3><a class="toc-backref" href="#id33" role="doc-backlink">Visualization</a><a class="headerlink" href="#visualization" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot treatment effects over time</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Customize the plot</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">graph_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Treatment Effects Over Time&#39;</span><span class="p">,</span> <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s1">&#39;Effect Size&#39;</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="export-results">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">Export Results</a><a class="headerlink" href="#export-results" title="Link to this heading">ïƒ</a></h3>
<p>Excel:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;results.xlsx&#39;</span><span class="p">)</span>
<span class="c1"># Creates sheets: Summary, ByPeriod, and RI (if available)</span>
</pre></div>
</div>
<p>CSV:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;results.csv&#39;</span><span class="p">)</span>
<span class="c1"># Exports period-by-period estimates</span>
</pre></div>
</div>
<p>LaTeX:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="s1">&#39;table.tex&#39;</span><span class="p">)</span>
<span class="c1"># Creates publication-ready LaTeX table</span>
</pre></div>
</div>
</section>
<section id="print-summary">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">Print Summary</a><a class="headerlink" href="#print-summary" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>  <span class="c1"># Prints formatted summary to console</span>
</pre></div>
</div>
</section>
</section>
<section id="data-requirements-and-validation">
<h2><a class="toc-backref" href="#id36" role="doc-backlink">Data Requirements and Validation</a><a class="headerlink" href="#data-requirements-and-validation" title="Link to this heading">ïƒ</a></h2>
<section id="panel-structure">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">Panel Structure</a><a class="headerlink" href="#panel-structure" title="Link to this heading">ïƒ</a></h3>
<p><strong>Required format</strong>:</p>
<ul class="simple">
<li><p>Long format: one row per (unit, time) observation</p></li>
<li><p>Unique (unit, time) combinations</p></li>
<li><p>Continuous time sequence (no gaps in time index)</p></li>
</ul>
<p><strong>Validation</strong>:</p>
<p>The package automatically validates:</p>
<ul class="simple">
<li><p>No duplicate (unit, time) pairs</p></li>
<li><p>Time index forms continuous sequence</p></li>
<li><p>Sufficient pre-treatment periods for chosen transformation</p></li>
</ul>
</section>
<section id="treatment-structure">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">Treatment Structure</a><a class="headerlink" href="#treatment-structure" title="Link to this heading">ïƒ</a></h3>
<p><strong>Common timing assumption</strong>:</p>
<p>All treated units must start treatment in the same period. The <code class="docutils literal notranslate"><span class="pre">post</span></code>
variable must be a function of time only.</p>
<p><strong>Treatment persistence</strong>:</p>
<p>Once <code class="docutils literal notranslate"><span class="pre">post</span></code> switches from 0 to 1, it must remain 1 for all subsequent
periods (no reversals).</p>
<p><strong>Validation</strong>:</p>
<p>The package checks:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">post</span></code> is binary (0 or 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">post</span></code> is time-invariant across units in each period</p></li>
<li><p>No treatment reversals</p></li>
</ul>
</section>
<section id="treatment-indicator">
<h3><a class="toc-backref" href="#id39" role="doc-backlink">Treatment Indicator</a><a class="headerlink" href="#treatment-indicator" title="Link to this heading">ïƒ</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">d</span></code> parameter must be a time-invariant treatment group indicator:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">1</span></code> for all periods if unit is in treatment group</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">0</span></code> for all periods if unit is in control group</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> should NOT vary over time</p></li>
</ul>
<p>Common mistake: Passing time-varying treatment status instead of group indicator.</p>
</section>
<section id="missing-data">
<h3><a class="toc-backref" href="#id40" role="doc-backlink">Missing Data</a><a class="headerlink" href="#missing-data" title="Link to this heading">ïƒ</a></h3>
<p><strong>Allowed</strong>:</p>
<ul class="simple">
<li><p>Missing values in outcome variable <code class="docutils literal notranslate"><span class="pre">y</span></code> (observations dropped)</p></li>
<li><p>Unbalanced panels (different units can have different numbers of periods)</p></li>
</ul>
<p><strong>Not allowed</strong>:</p>
<ul class="simple">
<li><p>Rows with missing values in <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">ivar</span></code>, <code class="docutils literal notranslate"><span class="pre">tvar</span></code>, or <code class="docutils literal notranslate"><span class="pre">post</span></code> (these observations are dropped during validation)</p></li>
<li><p>Gaps in time sequence</p></li>
</ul>
</section>
</section>
<section id="never-treated-unit-data-preparation">
<h2><a class="toc-backref" href="#id41" role="doc-backlink">Never-Treated Unit Data Preparation</a><a class="headerlink" href="#never-treated-unit-data-preparation" title="Link to this heading">ïƒ</a></h2>
<p>In staggered adoption designs, never-treated units serve as the control group.
Proper encoding of never-treated units is essential for correct estimation.</p>
<section id="valid-never-treated-encodings">
<h3><a class="toc-backref" href="#id42" role="doc-backlink">Valid Never-Treated Encodings</a><a class="headerlink" href="#valid-never-treated-encodings" title="Link to this heading">ïƒ</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">gvar</span></code> column can encode never-treated units using any of these values:</p>
<ol class="arabic">
<li><p><strong>Zero (0)</strong>: Common in Stata and other software</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Convert NaN to 0</span>
</pre></div>
</div>
</li>
<li><p><strong>Positive infinity (np.inf)</strong>: Represents â€œtreated at infinityâ€</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;never_treated&#39;</span><span class="p">],</span> <span class="s1">&#39;gvar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
</pre></div>
</div>
</li>
<li><p><strong>NaN/NA/None</strong>: Missing treatment time indicates never-treated</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># NaN is automatically recognized as never-treated</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;first_treat_year&#39;</span><span class="p">]</span>  <span class="c1"># NaN for never-treated</span>
</pre></div>
</div>
</li>
</ol>
<p>All three encodings are equivalent and produce identical results.</p>
</section>
<section id="converting-from-stata-data">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">Converting from Stata Data</a><a class="headerlink" href="#converting-from-stata-data" title="Link to this heading">ïƒ</a></h3>
<p>When importing data from Stata, never-treated units may be encoded differently:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Load Stata data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;staggered_data.dta&#39;</span><span class="p">)</span>

<span class="c1"># Common Stata encodings for never-treated:</span>
<span class="c1"># - Missing values (.) â†’ automatically become NaN in pandas</span>
<span class="c1"># - Zero (0) â†’ recognized as never-treated</span>
<span class="c1"># - Large values (9999) â†’ need manual conversion</span>

<span class="c1"># Convert custom encoding to standard format</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">9999</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

<span class="c1"># Verify never-treated identification</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lwdid.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_never_treated</span>
<span class="n">unit_gvar</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">)[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">n_nt</span> <span class="o">=</span> <span class="n">unit_gvar</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_never_treated</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Never-treated units: </span><span class="si">{</span><span class="n">n_nt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="checking-never-treated-status">
<h3><a class="toc-backref" href="#id44" role="doc-backlink">Checking Never-Treated Status</a><a class="headerlink" href="#checking-never-treated-status" title="Link to this heading">ïƒ</a></h3>
<p>Use the <code class="docutils literal notranslate"><span class="pre">is_never_treated()</span></code> function to verify encoding:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lwdid.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_never_treated</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Check individual values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">is_never_treated</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>        <span class="c1"># True</span>
<span class="nb">print</span><span class="p">(</span><span class="n">is_never_treated</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>   <span class="c1"># True</span>
<span class="nb">print</span><span class="p">(</span><span class="n">is_never_treated</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>   <span class="c1"># True</span>
<span class="nb">print</span><span class="p">(</span><span class="n">is_never_treated</span><span class="p">(</span><span class="mi">2005</span><span class="p">))</span>     <span class="c1"># False</span>

<span class="c1"># Check DataFrame</span>
<span class="n">unit_gvar</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">)[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">nt_mask</span> <span class="o">=</span> <span class="n">unit_gvar</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_never_treated</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total units: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unit_gvar</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Never-treated: </span><span class="si">{</span><span class="n">nt_mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Treated: </span><span class="si">{</span><span class="p">(</span><span class="o">~</span><span class="n">nt_mask</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="common-issues-and-solutions">
<h3><a class="toc-backref" href="#id45" role="doc-backlink">Common Issues and Solutions</a><a class="headerlink" href="#common-issues-and-solutions" title="Link to this heading">ïƒ</a></h3>
<p><strong>Issue: No never-treated units found</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check gvar values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="c1"># If using custom encoding (e.g., 9999 for never-treated)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">9999</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
<p><strong>Issue: Negative gvar values</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Negative values are invalid</span>
<span class="k">if</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Negative gvar values found&quot;</span><span class="p">)</span>
    <span class="c1"># Convert to valid encoding</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;gvar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p><strong>Issue: gvar varies within unit</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># gvar must be time-invariant</span>
<span class="n">gvar_varies</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">)[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="k">if</span> <span class="n">gvar_varies</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Units with varying gvar: </span><span class="si">{</span><span class="n">gvar_varies</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Use first observation&#39;s gvar</span>
    <span class="n">first_gvar</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;unit&#39;</span><span class="p">)[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gvar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">first_gvar</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="best-practices">
<h2><a class="toc-backref" href="#id46" role="doc-backlink">Best Practices</a><a class="headerlink" href="#best-practices" title="Link to this heading">ïƒ</a></h2>
<section id="choosing-transformation-method">
<h3><a class="toc-backref" href="#id47" role="doc-backlink">Choosing Transformation Method</a><a class="headerlink" href="#choosing-transformation-method" title="Link to this heading">ïƒ</a></h3>
<ol class="arabic simple">
<li><p><strong>Start with ``demean``</strong> for annual data</p></li>
<li><p><strong>Use ``detrend``</strong> if pre-treatment trends differ across units</p></li>
<li><p><strong>Use ``demeanq``/``detrendq``</strong> for quarterly data with seasonality</p></li>
<li><p><strong>Check pre-treatment period requirements</strong> (<span class="math notranslate nohighlight">\(T_0 \geq 1\)</span> for demean,
<span class="math notranslate nohighlight">\(T_0 \geq 2\)</span> for detrend)</p></li>
</ol>
</section>
<section id="choosing-variance-estimator">
<h3><a class="toc-backref" href="#id48" role="doc-backlink">Choosing Variance Estimator</a><a class="headerlink" href="#choosing-variance-estimator" title="Link to this heading">ïƒ</a></h3>
<ol class="arabic simple">
<li><p><strong>Default (``vce=None``)</strong>: Appropriate when homoskedasticity is plausible</p></li>
<li><p><strong>``vce=â€™hc3â€™``</strong>: Recommended for small to moderate sample sizes when heteroskedasticity is suspected</p></li>
<li><p><strong>``vce=â€™clusterâ€™``</strong>: Appropriate when errors are clustered</p></li>
<li><p><strong>Randomization inference</strong>: Use as robustness check or when normality is doubtful</p></li>
</ol>
</section>
<section id="sample-size-considerations">
<h3><a class="toc-backref" href="#id49" role="doc-backlink">Sample Size Considerations</a><a class="headerlink" href="#sample-size-considerations" title="Link to this heading">ïƒ</a></h3>
<ul class="simple">
<li><p><strong>Small samples (N &lt; 50):</strong> Use exact t-based inference (<code class="docutils literal notranslate"><span class="pre">vce=None</span></code>) under
CLM assumptions (normality and homoskedasticity). Minimum requirement is
<span class="math notranslate nohighlight">\(N \geq 3\)</span> units. Having at least 10 units improves stability.</p></li>
<li><p><strong>Moderate to large samples (N &gt;= 50):</strong> Use heteroskedasticity-robust
standard errors (<code class="docutils literal notranslate"><span class="pre">vce='hc3'</span></code>) for valid asymptotic inference.</p></li>
<li><p><strong>Large samples with controls:</strong> Consider IPWRA (<code class="docutils literal notranslate"><span class="pre">estimator='ipwra'</span></code>) for
doubly robust estimation when functional form assumptions are uncertain.</p></li>
<li><p><strong>Time dimension:</strong> Method works best with large T (many time periods), where
the central limit theorem across time supports normality of the transformed
outcome.</p></li>
<li><p><strong>Asymptotic theory:</strong> Lee and Wooldridge (2025) develops the theoretical
foundation for large-sample inference, supporting HC0-HC4 and cluster-robust
standard errors.</p></li>
</ul>
</section>
<section id="sample-size-and-inference-method-selection-matrix">
<h3><a class="toc-backref" href="#id50" role="doc-backlink">Sample Size and Inference Method Selection Matrix</a><a class="headerlink" href="#sample-size-and-inference-method-selection-matrix" title="Link to this heading">ïƒ</a></h3>
<p>The following matrix provides guidance on selecting the appropriate estimator
and inference method based on sample size:</p>
<p><strong>Small Samples (N &lt; 50):</strong></p>
<ul class="simple">
<li><p><strong>Recommended</strong>: RA with <code class="docutils literal notranslate"><span class="pre">vce=None</span></code> (exact t-based inference)</p></li>
<li><p><strong>Alternative</strong>: RA with <code class="docutils literal notranslate"><span class="pre">ri=True</span></code> (randomization inference)</p></li>
<li><p><strong>VCE options</strong>: <code class="docutils literal notranslate"><span class="pre">vce=None</span></code> or <code class="docutils literal notranslate"><span class="pre">vce='hc3'</span></code></p></li>
<li><p><strong>Inference distribution</strong>: t-distribution</p></li>
<li><p><strong>Key assumption</strong>: CLM assumptions (normality, homoskedasticity) for exact inference</p></li>
</ul>
<p><strong>Moderate Samples (50 â‰¤ N &lt; 200):</strong></p>
<ul class="simple">
<li><p><strong>Recommended</strong>: RA or IPWRA with <code class="docutils literal notranslate"><span class="pre">vce='hc3'</span></code></p></li>
<li><p><strong>VCE options</strong>: <code class="docutils literal notranslate"><span class="pre">vce='hc1'</span></code>, <code class="docutils literal notranslate"><span class="pre">vce='hc3'</span></code>, or <code class="docutils literal notranslate"><span class="pre">vce='cluster'</span></code></p></li>
<li><p><strong>Inference distribution</strong>: t-distribution (RA) or normal (IPW/IPWRA/PSM)</p></li>
<li><p><strong>Key consideration</strong>: HC3 provides better finite-sample performance</p></li>
</ul>
<p><strong>Large Samples (N â‰¥ 200):</strong></p>
<ul class="simple">
<li><p><strong>Recommended</strong>: IPWRA with <code class="docutils literal notranslate"><span class="pre">vce='hc1'</span></code> or <code class="docutils literal notranslate"><span class="pre">vce='robust'</span></code></p></li>
<li><p><strong>Alternative</strong>: RA, IPW, or PSM depending on substantive considerations</p></li>
<li><p><strong>VCE options</strong>: All HC variants and cluster-robust</p></li>
<li><p><strong>Inference distribution</strong>: t-distribution (RA) or normal (IPW/IPWRA/PSM)</p></li>
<li><p><strong>Key advantage</strong>: Double robustness of IPWRA protects against misspecification</p></li>
</ul>
<p><strong>Inference Distribution by Estimator:</strong></p>
<ul class="simple">
<li><p><strong>RA (Regression Adjustment)</strong>: t-distribution with df = N - k</p></li>
<li><p><strong>IPW (Inverse Probability Weighting)</strong>: Normal distribution (asymptotic)</p></li>
<li><p><strong>IPWRA (Doubly Robust)</strong>: Normal distribution (asymptotic)</p></li>
<li><p><strong>PSM (Propensity Score Matching)</strong>: Normal distribution (asymptotic)</p></li>
</ul>
<p>For detailed theoretical foundations, see <a class="reference internal" href="methodological_notes.html"><span class="doc">Methodological Notes</span></a>.</p>
</section>
<section id="estimator-selection-large-sample-common-timing">
<h3><a class="toc-backref" href="#id51" role="doc-backlink">Estimator Selection (Large-Sample Common Timing)</a><a class="headerlink" href="#estimator-selection-large-sample-common-timing" title="Link to this heading">ïƒ</a></h3>
<p>For large cross-sectional samples in common timing settings, multiple estimators
are available beyond regression adjustment. Lee and Wooldridge (2025) shows
that the rolling transformation approach enables application of various treatment
effects estimators, including doubly robust methods.</p>
<p><strong>Available estimators for common timing:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'ra'</span></code> (default): Regression adjustment via OLS. Consistent when the outcome
model is correctly specified. Efficient under correct specification.
Uses t-distribution for inference.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ipw'</span></code>: Inverse probability weighting. Consistent when the propensity score
model is correctly specified. Requires <code class="docutils literal notranslate"><span class="pre">controls</span></code> parameter.
Uses normal distribution for asymptotic inference.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ipwra'</span></code>: Doubly robust estimator combining regression and IPW. Consistent
when either the outcome model or propensity score is correctly specified.
Recommended when functional form assumptions are uncertain.
Uses normal distribution for asymptotic inference.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'psm'</span></code>: Propensity score matching. Matches treated to control units based
on propensity scores. Requires adequate sample sizes for matching.
Uses normal distribution for asymptotic inference.</p></li>
</ul>
<p><strong>Example (IPWRA in common timing):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;treated&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">post</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span><span class="p">,</span>
    <span class="n">estimator</span><span class="o">=</span><span class="s1">&#39;ipwra&#39;</span><span class="p">,</span>           <span class="c1"># Doubly robust estimator</span>
    <span class="n">controls</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span>       <span class="c1"># Controls for outcome and PS models</span>
    <span class="n">vce</span><span class="o">=</span><span class="s1">&#39;hc3&#39;</span>                    <span class="c1"># Robust standard errors</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Estimator selection guidelines:</strong></p>
<ol class="arabic simple">
<li><p><strong>Small samples (N &lt; 50)</strong>: Use RA with <code class="docutils literal notranslate"><span class="pre">vce=None</span></code> for exact t-based
inference under CLM assumptions</p></li>
<li><p><strong>Moderate samples (50 â‰¤ N &lt; 200)</strong>: Start with RA and <code class="docutils literal notranslate"><span class="pre">vce='hc3'</span></code>; use
IPWRA as robustness check</p></li>
<li><p><strong>Large samples (N â‰¥ 200)</strong>: Use IPWRA as primary estimator when functional
form assumptions are uncertain</p></li>
<li><p><strong>All sample sizes</strong>: Use randomization inference (<code class="docutils literal notranslate"><span class="pre">ri=True</span></code>) as a
robustness check that does not rely on distributional assumptions</p></li>
</ol>
</section>
<section id="diagnostic-checks">
<h3><a class="toc-backref" href="#id52" role="doc-backlink">Diagnostic Checks</a><a class="headerlink" href="#diagnostic-checks" title="Link to this heading">ïƒ</a></h3>
<ol class="arabic simple">
<li><p>Visual inspection: Plot outcome trends for treated vs. control units</p></li>
<li><p>Pre-treatment balance: Check if treated and control units are similar pre-treatment</p></li>
<li><p>Parallel trends: Examine pre-treatment period-specific effects (should be near zero)</p></li>
<li><p>Sensitivity: Try different transformation methods and variance estimators</p></li>
</ol>
</section>
</section>
<section id="troubleshooting">
<h2><a class="toc-backref" href="#id53" role="doc-backlink">Troubleshooting</a><a class="headerlink" href="#troubleshooting" title="Link to this heading">ïƒ</a></h2>
<section id="common-errors">
<h3><a class="toc-backref" href="#id54" role="doc-backlink">Common Errors</a><a class="headerlink" href="#common-errors" title="Link to this heading">ïƒ</a></h3>
<p><strong>â€œInsufficient pre-treatment periodsâ€</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">demean</span></code>/<code class="docutils literal notranslate"><span class="pre">demeanq</span></code> require <span class="math notranslate nohighlight">\(T_0 \geq 1\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detrend</span></code>/<code class="docutils literal notranslate"><span class="pre">detrendq</span></code> require <span class="math notranslate nohighlight">\(T_0 \geq 2\)</span></p></li>
<li><p>Solution: Check your <code class="docutils literal notranslate"><span class="pre">post</span></code> variable or use a different transformation</p></li>
</ul>
<p><strong>â€œTreatment timing is not common across unitsâ€</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">post</span></code> must be the same for all units in each period</p></li>
<li><p>Solution: Verify your <code class="docutils literal notranslate"><span class="pre">post</span></code> variable is time-based, not unit-specific</p></li>
</ul>
<p><strong>â€œControl variable varies within unitâ€</strong>:</p>
<ul class="simple">
<li><p>Controls must be time-invariant</p></li>
<li><p>Solution: Use only time-invariant controls or create unit-level averages</p></li>
</ul>
<p><strong>â€œDuplicate (unit, time) observationsâ€</strong>:</p>
<ul class="simple">
<li><p>Each (unit, time) combination must appear only once</p></li>
<li><p>Solution: Check for data duplication or aggregation issues</p></li>
</ul>
</section>
<section id="performance-tips">
<h3><a class="toc-backref" href="#id55" role="doc-backlink">Performance Tips</a><a class="headerlink" href="#performance-tips" title="Link to this heading">ïƒ</a></h3>
<ul class="simple">
<li><p>For large <code class="docutils literal notranslate"><span class="pre">rireps</span></code> (e.g., 10,000), RI can be slow</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">seed</span></code> parameter for reproducible RI results</p></li>
<li><p>Export results to Excel/CSV for further analysis in other tools</p></li>
</ul>
</section>
</section>
<section id="staggered-adoption-design">
<h2><a class="toc-backref" href="#id56" role="doc-backlink">Staggered Adoption Design</a><a class="headerlink" href="#staggered-adoption-design" title="Link to this heading">ïƒ</a></h2>
<p>When units are treated at different times, use the staggered adoption framework.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Staggered transformation options</strong>: All four transformation methods
(<code class="docutils literal notranslate"><span class="pre">demean</span></code>, <code class="docutils literal notranslate"><span class="pre">detrend</span></code>, <code class="docutils literal notranslate"><span class="pre">demeanq</span></code>, <code class="docutils literal notranslate"><span class="pre">detrendq</span></code>) are available for
staggered designs. Seasonal transformations (<code class="docutils literal notranslate"><span class="pre">demeanq</span></code>, <code class="docutils literal notranslate"><span class="pre">detrendq</span></code>)
require sufficient pre-treatment observations for each cohort to estimate
seasonal parameters (at least Q+1 periods for <code class="docutils literal notranslate"><span class="pre">demeanq</span></code>, Q+2 for
<code class="docutils literal notranslate"><span class="pre">detrendq</span></code>, where Q is the number of seasonal periods).</p>
</div>
<section id="id2">
<h3><a class="toc-backref" href="#id57" role="doc-backlink">Basic Usage</a><a class="headerlink" href="#id2" title="Link to this heading">ïƒ</a></h3>
<p>Instead of <code class="docutils literal notranslate"><span class="pre">post</span></code> (common timing), specify <code class="docutils literal notranslate"><span class="pre">gvar</span></code> (first treatment period):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span>
    <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;first_treat_year&#39;</span><span class="p">,</span>  <span class="c1"># First treatment period for each unit</span>
    <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span><span class="p">,</span>
    <span class="n">aggregate</span><span class="o">=</span><span class="s1">&#39;overall&#39;</span><span class="p">,</span>      <span class="c1"># Aggregate to overall effect</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="staggered-specific-parameters">
<h3><a class="toc-backref" href="#id58" role="doc-backlink">Staggered-Specific Parameters</a><a class="headerlink" href="#staggered-specific-parameters" title="Link to this heading">ïƒ</a></h3>
<dl>
<dt><strong>gvar</strong><span class="classifier">str</span></dt><dd><p>Column name indicating the first treatment period for each unit.
Units with <code class="docutils literal notranslate"><span class="pre">gvar</span> <span class="pre">=</span> <span class="pre">inf</span></code> or <code class="docutils literal notranslate"><span class="pre">gvar</span> <span class="pre">=</span> <span class="pre">NaN</span></code> are never treated.</p>
</dd>
<dt><strong>aggregate</strong><span class="classifier">{â€˜noneâ€™, â€˜cohortâ€™, â€˜overallâ€™}</span></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'none'</span></code>: Return (g,r)-specific effects only</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cohort'</span></code>: Average effects within each cohort (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'overall'</span></code>: Weighted average across cohorts</p></li>
</ul>
</dd>
<dt><strong>control_group</strong><span class="classifier">{â€˜not_yet_treatedâ€™, â€˜never_treatedâ€™}</span></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'not_yet_treated'</span></code>: Use never-treated plus not-yet-treated units (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'never_treated'</span></code>: Use only never-treated units</p></li>
</ul>
</dd>
<dt><strong>estimator</strong><span class="classifier">{â€˜raâ€™, â€˜ipwâ€™, â€˜ipwraâ€™, â€˜psmâ€™}</span></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'ra'</span></code>: Regression adjustment (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ipw'</span></code>: Inverse probability weighting</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ipwra'</span></code>: Doubly robust (recommended)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'psm'</span></code>: Propensity score matching</p></li>
</ul>
</dd>
<dt><strong>exclude_pre_periods</strong><span class="classifier">int, default 0</span></dt><dd><p>Number of periods immediately before treatment to exclude from pre-treatment
calculations. Used for robustness checks when the no-anticipation assumption
may be violated.</p>
<p>For cohort g, the pre-treatment mean/trend is computed using periods
{T_min, â€¦, g-1-exclude_pre_periods} instead of {T_min, â€¦, g-1}.</p>
<p>See Lee and Wooldridge (2025) Section 6 for methodological details.</p>
</dd>
</dl>
</section>
<section id="robustness-to-no-anticipation-violations">
<h3><a class="toc-backref" href="#id59" role="doc-backlink">Robustness to No-Anticipation Violations</a><a class="headerlink" href="#robustness-to-no-anticipation-violations" title="Link to this heading">ïƒ</a></h3>
<p>When the no-anticipation assumption may be violated (e.g., units adjust behavior
before formal treatment), the <code class="docutils literal notranslate"><span class="pre">exclude_pre_periods</span></code> parameter can be used to
perform robustness checks.</p>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Baseline estimation</span>
<span class="n">result_baseline</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;cohort&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span>
<span class="p">)</span>

<span class="c1"># Robustness check: exclude 1 period before treatment</span>
<span class="n">result_robust1</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;cohort&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span><span class="p">,</span>
    <span class="n">exclude_pre_periods</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># Robustness check: exclude 2 periods before treatment</span>
<span class="n">result_robust2</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;cohort&#39;</span><span class="p">,</span> <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span><span class="p">,</span>
    <span class="n">exclude_pre_periods</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1"># Compare results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Baseline ATT: </span><span class="si">{</span><span class="n">result_baseline</span><span class="o">.</span><span class="n">att_overall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exclude 1 period: </span><span class="si">{</span><span class="n">result_robust1</span><span class="o">.</span><span class="n">att_overall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exclude 2 periods: </span><span class="si">{</span><span class="n">result_robust2</span><span class="o">.</span><span class="n">att_overall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Minimum pre-treatment period requirements</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">demean</span></code>: At least 1 pre-treatment period remaining after exclusion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detrend</span></code>: At least 2 pre-treatment periods remaining after exclusion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">demeanq</span></code>: At least Q+1 pre-treatment periods remaining (Q = number of seasons)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detrendq</span></code>: At least Q+2 pre-treatment periods remaining</p></li>
</ul>
<p>If any cohort has insufficient pre-treatment periods after applying
<code class="docutils literal notranslate"><span class="pre">exclude_pre_periods</span></code>, an <code class="docutils literal notranslate"><span class="pre">InsufficientPrePeriodsError</span></code> is raised.</p>
</section>
<section id="accessing-staggered-results">
<h3><a class="toc-backref" href="#id60" role="doc-backlink">Accessing Staggered Results</a><a class="headerlink" href="#accessing-staggered-results" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Overall weighted effect</span>
<span class="n">results</span><span class="o">.</span><span class="n">att_overall</span>       <span class="c1"># ATT estimate</span>
<span class="n">results</span><span class="o">.</span><span class="n">se_overall</span>        <span class="c1"># Standard error</span>

<span class="c1"># Cohort-specific effects</span>
<span class="n">df_cohorts</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">att_by_cohort</span>

<span class="c1"># Cohort-time specific effects</span>
<span class="n">df_gt</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">att_by_cohort_time</span>

<span class="c1"># Event study visualization</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">plot_event_study</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="control-group-strategies">
<h3><a class="toc-backref" href="#id61" role="doc-backlink">Control Group Strategies</a><a class="headerlink" href="#control-group-strategies" title="Link to this heading">ïƒ</a></h3>
<p><strong>Not-yet-treated (default)</strong>:</p>
<p>Uses both never-treated units and units that will be treated in future periods.
More efficient but requires stronger no-anticipation assumption.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">control_group</span><span class="o">=</span><span class="s1">&#39;not_yet_treated&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Never-treated only</strong>:</p>
<p>Uses only units that are never treated during the observation period.
More robust but potentially less efficient.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">control_group</span><span class="o">=</span><span class="s1">&#39;never_treated&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="estimator-selection">
<h3><a class="toc-backref" href="#id62" role="doc-backlink">Estimator Selection</a><a class="headerlink" href="#estimator-selection" title="Link to this heading">ïƒ</a></h3>
<p><strong>Regression Adjustment (RA)</strong>:</p>
<ul class="simple">
<li><p>Consistent when conditional mean is correctly specified</p></li>
<li><p>Default estimator, efficient under correct specification</p></li>
</ul>
<p><strong>Doubly Robust (IPWRA)</strong>:</p>
<ul class="simple">
<li><p>Consistent if either outcome model or propensity score is correct</p></li>
<li><p>Recommended when functional form assumptions are uncertain</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="s1">&#39;ipwra&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Inverse Probability Weighting (IPW)</strong>:</p>
<ul class="simple">
<li><p>Weights by propensity score</p></li>
<li><p>Consistent when propensity score is correctly specified</p></li>
</ul>
<p><strong>Propensity Score Matching (PSM)</strong>:</p>
<ul class="simple">
<li><p>Matches treated to control units by propensity score</p></li>
<li><p>Use when sample sizes are adequate for matching</p></li>
</ul>
</section>
<section id="staggered-example">
<h3><a class="toc-backref" href="#id63" role="doc-backlink">Staggered Example</a><a class="headerlink" href="#staggered-example" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lwdid</span><span class="w"> </span><span class="kn">import</span> <span class="n">lwdid</span>

<span class="c1"># Load castle law data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;castle.csv&#39;</span><span class="p">)</span>

<span class="c1"># Estimate with staggered design</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;l_homicide&#39;</span><span class="p">,</span>
    <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;effyear&#39;</span><span class="p">,</span>
    <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span><span class="p">,</span>
    <span class="n">aggregate</span><span class="o">=</span><span class="s1">&#39;overall&#39;</span><span class="p">,</span>
    <span class="n">control_group</span><span class="o">=</span><span class="s1">&#39;not_yet_treated&#39;</span><span class="p">,</span>
    <span class="n">estimator</span><span class="o">=</span><span class="s1">&#39;ipwra&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># Event study plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">plot_event_study</span><span class="p">(</span>
    <span class="n">include_pre_treatment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_ci</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="pre-treatment-dynamics-and-parallel-trends-testing">
<h2><a class="toc-backref" href="#id64" role="doc-backlink">Pre-treatment Dynamics and Parallel Trends Testing</a><a class="headerlink" href="#pre-treatment-dynamics-and-parallel-trends-testing" title="Link to this heading">ïƒ</a></h2>
<p>Pre-treatment dynamics analysis enables assessment of the parallel trends
assumption validity by estimating treatment effects in pre-treatment periods. Under
the null hypothesis of parallel trends, these pre-treatment effects should be zero.</p>
<p>This feature implements the methodology from Lee and Wooldridge (2025) Appendix D,
using rolling transformations that look forward to future pre-treatment periods
rather than backward.</p>
<section id="why-pre-treatment-dynamics-matter">
<h3><a class="toc-backref" href="#id65" role="doc-backlink">Why Pre-treatment Dynamics Matter</a><a class="headerlink" href="#why-pre-treatment-dynamics-matter" title="Link to this heading">ïƒ</a></h3>
<p>The parallel trends assumption is fundamental to difference-in-differences
identification. While this assumption cannot be directly tested (it concerns
counterfactual outcomes), examining pre-treatment dynamics provides indirect
evidence:</p>
<ul class="simple">
<li><p><strong>Under parallel trends</strong>: Pre-treatment ATT estimates should be approximately
zero (within sampling variation)</p></li>
<li><p><strong>Violation of parallel trends</strong>: Systematic non-zero pre-treatment effects
suggest the control group may not provide a valid counterfactual</p></li>
</ul>
<p>The anchor point convention sets the effect at event time e = -1 (the period
immediately before treatment) to exactly zero, providing a reference point for
interpreting other pre-treatment effects.</p>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id66" role="doc-backlink">Basic Usage</a><a class="headerlink" href="#id3" title="Link to this heading">ïƒ</a></h3>
<p>Enable pre-treatment dynamics by setting <code class="docutils literal notranslate"><span class="pre">include_pretreatment=True</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lwdid</span><span class="w"> </span><span class="kn">import</span> <span class="n">lwdid</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span>
    <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;first_treat&#39;</span><span class="p">,</span>
    <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span><span class="p">,</span>
    <span class="n">aggregate</span><span class="o">=</span><span class="s1">&#39;cohort&#39;</span><span class="p">,</span>
    <span class="n">include_pretreatment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>    <span class="c1"># Enable pre-treatment estimation</span>
    <span class="n">pretreatment_test</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>       <span class="c1"># Run parallel trends test (default)</span>
    <span class="n">pretreatment_alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>      <span class="c1"># Significance level (default)</span>
<span class="p">)</span>

<span class="c1"># View complete summary including pre-treatment results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="accessing-pre-treatment-results">
<h3><a class="toc-backref" href="#id67" role="doc-backlink">Accessing Pre-treatment Results</a><a class="headerlink" href="#accessing-pre-treatment-results" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pre-treatment ATT estimates as DataFrame</span>
<span class="n">pre_df</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">att_pre_treatment</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pre_df</span><span class="p">)</span>
<span class="c1"># Columns: cohort, period, event_time, att, se, ci_lower, ci_upper,</span>
<span class="c1">#          t_stat, pvalue, n_treated, n_control, is_anchor, rolling_window_size</span>

<span class="c1"># Parallel trends test results</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">parallel_trends_test</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joint F-statistic: </span><span class="si">{</span><span class="n">pt</span><span class="o">.</span><span class="n">joint_f_stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joint p-value: </span><span class="si">{</span><span class="n">pt</span><span class="o">.</span><span class="n">joint_pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reject parallel trends: </span><span class="si">{</span><span class="n">pt</span><span class="o">.</span><span class="n">reject_null</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of pre-treatment periods tested: </span><span class="si">{</span><span class="n">pt</span><span class="o">.</span><span class="n">n_periods</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="interpreting-the-parallel-trends-test">
<h3><a class="toc-backref" href="#id68" role="doc-backlink">Interpreting the Parallel Trends Test</a><a class="headerlink" href="#interpreting-the-parallel-trends-test" title="Link to this heading">ïƒ</a></h3>
<p>The parallel trends test performs a joint F-test of the null hypothesis that all
pre-treatment ATT estimates (excluding the anchor point) are jointly zero:</p>
<ul class="simple">
<li><p><strong>H0</strong>: All pre-treatment ATT = 0 (parallel trends holds)</p></li>
<li><p><strong>H1</strong>: At least one pre-treatment ATT â‰  0 (parallel trends violated)</p></li>
</ul>
<p><strong>Interpretation guidelines</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reject_null=False</span></code>: No statistical evidence against parallel trends. This
does not prove parallel trends holds, but the data are consistent with it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reject_null=True</span></code>: Evidence of pre-treatment differences. Consider:</p>
<ul>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">detrend</span></code> instead of <code class="docutils literal notranslate"><span class="pre">demean</span></code> to allow for heterogeneous trends</p></li>
<li><p>Examining which cohorts or periods show violations</p></li>
<li><p>Investigating potential anticipation effects or data issues</p></li>
</ul>
</li>
</ul>
</section>
<section id="event-study-visualization-with-pre-treatment">
<h3><a class="toc-backref" href="#id69" role="doc-backlink">Event Study Visualization with Pre-treatment</a><a class="headerlink" href="#event-study-visualization-with-pre-treatment" title="Link to this heading">ïƒ</a></h3>
<p>The event study plot can display both pre-treatment and post-treatment effects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot with pre-treatment effects</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">plot_event_study</span><span class="p">(</span>
    <span class="n">include_pre_treatment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>      <span class="c1"># Show pre-treatment effects</span>
    <span class="n">pre_treatment_color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>      <span class="c1"># Color for pre-treatment points</span>
    <span class="n">post_treatment_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>     <span class="c1"># Color for post-treatment points</span>
    <span class="n">show_anchor_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>           <span class="c1"># Vertical line at e=-1</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Event Study with Pre-treatment Dynamics&#39;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Treatment Effect&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;event_study_pretreatment.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p>The plot shows:</p>
<ul class="simple">
<li><p>Pre-treatment effects (e &lt; -1) in gray with confidence intervals</p></li>
<li><p>Anchor point (e = -1) at zero</p></li>
<li><p>Post-treatment effects (e â‰¥ 0) in blue with confidence intervals</p></li>
<li><p>Optional vertical dashed line at the anchor point</p></li>
</ul>
</section>
<section id="complete-workflow-example">
<h3><a class="toc-backref" href="#id70" role="doc-backlink">Complete Workflow Example</a><a class="headerlink" href="#complete-workflow-example" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lwdid</span><span class="w"> </span><span class="kn">import</span> <span class="n">lwdid</span>

<span class="c1"># Load data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;castle.csv&#39;</span><span class="p">)</span>

<span class="c1"># Step 1: Estimate with pre-treatment dynamics</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;l_homicide&#39;</span><span class="p">,</span>
    <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;effyear&#39;</span><span class="p">,</span>
    <span class="n">rolling</span><span class="o">=</span><span class="s1">&#39;demean&#39;</span><span class="p">,</span>
    <span class="n">aggregate</span><span class="o">=</span><span class="s1">&#39;cohort&#39;</span><span class="p">,</span>
    <span class="n">include_pretreatment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">pretreatment_test</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Step 2: Check parallel trends test</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">parallel_trends_test</span>
<span class="k">if</span> <span class="n">pt</span><span class="o">.</span><span class="n">reject_null</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Evidence against parallel trends!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F-stat: </span><span class="si">{</span><span class="n">pt</span><span class="o">.</span><span class="n">joint_f_stat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p-value: </span><span class="si">{</span><span class="n">pt</span><span class="o">.</span><span class="n">joint_pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Consider using rolling=&#39;detrend&#39; to allow heterogeneous trends&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No evidence against parallel trends&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F-stat: </span><span class="si">{</span><span class="n">pt</span><span class="o">.</span><span class="n">joint_f_stat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, p-value: </span><span class="si">{</span><span class="n">pt</span><span class="o">.</span><span class="n">joint_pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Step 3: Examine pre-treatment effects</span>
<span class="n">pre_df</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">att_pre_treatment</span>
<span class="n">non_anchor</span> <span class="o">=</span> <span class="n">pre_df</span><span class="p">[</span><span class="o">~</span><span class="n">pre_df</span><span class="p">[</span><span class="s1">&#39;is_anchor&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pre-treatment effects (excluding anchor):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">non_anchor</span><span class="p">[[</span><span class="s1">&#39;event_time&#39;</span><span class="p">,</span> <span class="s1">&#39;att&#39;</span><span class="p">,</span> <span class="s1">&#39;se&#39;</span><span class="p">,</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Step 4: Visualize</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">plot_event_study</span><span class="p">(</span>
    <span class="n">include_pre_treatment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Castle Doctrine: Event Study with Pre-treatment&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;castle_event_study.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

<span class="c1"># Step 5: Report main results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Overall ATT: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">att_overall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (SE: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">se_overall</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="transformation-methods-for-pre-treatment">
<h3><a class="toc-backref" href="#id71" role="doc-backlink">Transformation Methods for Pre-treatment</a><a class="headerlink" href="#transformation-methods-for-pre-treatment" title="Link to this heading">ïƒ</a></h3>
<p>Pre-treatment dynamics support both <code class="docutils literal notranslate"><span class="pre">demean</span></code> and <code class="docutils literal notranslate"><span class="pre">detrend</span></code> transformations:</p>
<p><strong>Demean (default)</strong>:</p>
<p>Uses rolling demeaning with future pre-treatment periods. For period t &lt; g:</p>
<div class="math notranslate nohighlight">
\[\dot{Y}_{itg} = Y_{it} - \frac{1}{g-1-t} \sum_{q=t+1}^{g-1} Y_{iq}\]</div>
<p><strong>Detrend</strong>:</p>
<p>Uses rolling OLS detrending with future pre-treatment periods. Fits a linear
trend using periods {t+1, â€¦, g-1} and computes the residual.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">detrend</span></code> option is appropriate when cohorts are suspected to have different pre-treatment trends.</p>
</section>
</section>
<section id="trend-diagnostics-tools">
<h2><a class="toc-backref" href="#id72" role="doc-backlink">Trend Diagnostics Tools</a><a class="headerlink" href="#trend-diagnostics-tools" title="Link to this heading">ïƒ</a></h2>
<p>For exploratory analysis before running estimation, <code class="docutils literal notranslate"><span class="pre">lwdid</span></code> provides standalone
diagnostic functions in the <code class="docutils literal notranslate"><span class="pre">trend_diagnostics</span></code> module. These tools help assess
whether parallel trends holds and recommend an appropriate transformation method.</p>
<section id="testing-parallel-trends-with-standalone-function">
<h3><a class="toc-backref" href="#id73" role="doc-backlink">Testing Parallel Trends with Standalone Function</a><a class="headerlink" href="#testing-parallel-trends-with-standalone-function" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">lwdid</span>

<span class="c1"># Test parallel trends using placebo method</span>
<span class="n">pt_result</span> <span class="o">=</span> <span class="n">lwdid</span><span class="o">.</span><span class="n">test_parallel_trends</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span>
    <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit_id&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;first_treat&#39;</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;placebo&#39;</span><span class="p">,</span>   <span class="c1"># or &#39;regression&#39;, &#39;visual&#39;</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span>
<span class="p">)</span>

<span class="c1"># Display summary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pt_result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># Access individual results</span>
<span class="k">if</span> <span class="n">pt_result</span><span class="o">.</span><span class="n">reject_null</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parallel trends rejected (p=</span><span class="si">{</span><span class="n">pt_result</span><span class="o">.</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recommendation: </span><span class="si">{</span><span class="n">pt_result</span><span class="o">.</span><span class="n">recommendation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No evidence against parallel trends&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="diagnosing-heterogeneous-trends">
<h3><a class="toc-backref" href="#id74" role="doc-backlink">Diagnosing Heterogeneous Trends</a><a class="headerlink" href="#diagnosing-heterogeneous-trends" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Diagnose trend heterogeneity across cohorts</span>
<span class="n">ht_diag</span> <span class="o">=</span> <span class="n">lwdid</span><span class="o">.</span><span class="n">diagnose_heterogeneous_trends</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span>
    <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit_id&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;first_treat&#39;</span>
<span class="p">)</span>

<span class="c1"># Display summary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ht_diag</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># Check for heterogeneous trends</span>
<span class="k">if</span> <span class="n">ht_diag</span><span class="o">.</span><span class="n">has_heterogeneous_trends</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Heterogeneous trends detected&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recommendation: </span><span class="si">{</span><span class="n">ht_diag</span><span class="o">.</span><span class="n">recommendation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="getting-automated-transformation-recommendation">
<h3><a class="toc-backref" href="#id75" role="doc-backlink">Getting Automated Transformation Recommendation</a><a class="headerlink" href="#getting-automated-transformation-recommendation" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get data-driven recommendation</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">lwdid</span><span class="o">.</span><span class="n">recommend_transformation</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span>
    <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit_id&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;first_treat&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recommended method: </span><span class="si">{</span><span class="n">rec</span><span class="o">.</span><span class="n">recommended_method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence: </span><span class="si">{</span><span class="n">rec</span><span class="o">.</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">reason</span> <span class="ow">in</span> <span class="n">rec</span><span class="o">.</span><span class="n">reasons</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Use the recommendation</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">lwdid</span><span class="o">.</span><span class="n">lwdid</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span>
    <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit_id&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;first_treat&#39;</span><span class="p">,</span>
    <span class="n">rolling</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">recommended_method</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="visualizing-cohort-trends">
<h3><a class="toc-backref" href="#id76" role="doc-backlink">Visualizing Cohort Trends</a><a class="headerlink" href="#visualizing-cohort-trends" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot outcome trajectories by cohort</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">lwdid</span><span class="o">.</span><span class="n">plot_cohort_trends</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;outcome&#39;</span><span class="p">,</span>
    <span class="n">ivar</span><span class="o">=</span><span class="s1">&#39;unit_id&#39;</span><span class="p">,</span>
    <span class="n">tvar</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span>
    <span class="n">gvar</span><span class="o">=</span><span class="s1">&#39;first_treat&#39;</span><span class="p">,</span>
    <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span>    <span class="c1"># Normalize to first period</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cohort_trends.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="api/trend_diagnostics.html"><span class="doc">Trend Diagnostics Module (trend_diagnostics)</span></a> for complete API documentation.</p>
</section>
</section>
<section id="further-reading">
<h2><a class="toc-backref" href="#id77" role="doc-backlink">Further Reading</a><a class="headerlink" href="#further-reading" title="Link to this heading">ïƒ</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="quickstart.html"><span class="doc">Quick Start</span></a> - Quick start tutorial</p></li>
<li><p><a class="reference internal" href="methodological_notes.html"><span class="doc">Methodological Notes</span></a> - Theoretical background</p></li>
<li><p><a class="reference internal" href="api/index.html"><span class="doc">API Reference</span></a> - Complete API reference</p></li>
<li><p><a class="reference internal" href="api/staggered.html"><span class="doc">Staggered DiD Module (staggered)</span></a> - Staggered module API</p></li>
<li><p><a class="reference internal" href="examples/index.html"><span class="doc">Examples</span></a> - Usage examples</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples/index.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Xuanyu Cai, Wenli Xu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>